# otus_dp_pg
урок по созданию бэкапа и восстановлению из него.

# Создание виртуальной машины
- зашел на console.cloud.yandex.ru
- создал платежный аккаунт
- привязал к нему  виртуальную карту
- создал 7 виртуальных машин. 
- для связи использовал сгенерированный rsa ключ
машины создалась для убунты 22
  ssh -i ~/.ssh/yc_key otus@158.160.29.167
- ![тест1 ](../picture/lesson_06/p01.png)

## Вторая часть ДЗ
  


- установил etcd 
  настроил на внешние ip адреса
  ![etcd](../picture/lesson_06/p02.png)
  настроил на внутренние ip адреса
  ![etcd](../picture/lesson_06/p03.png)


- установка patroni
  первая установка patroni
  ![patroni](../picture/lesson_06/p04.png)
  не удача, связана с тем что поднял кластер на уже имеющийся, а не создал с нуля 
- вторая попытка
  удаляю кластер
  ![patroni](../picture/lesson_06/p05.png)
- удалил все старые файлы
  ![patroni](../picture/lesson_06/p06.png)
- запустил снова
  ![patroni](../picture/lesson_06/p07.png)
  все запустилось. Помощь оказал Авдонин Алексей.   
- установил pgbauncer
  ![pgbauncer](../picture/lesson_06/p08.png)
- на выделенную машину поставил HAProxy
  ![HAProxy](../picture/lesson_06/p09.png)
  проверил соединение
 
